
use darkelf::draw::DrawUtils;
use darkelf::command::CommandGenerator;
use ttf_parser::Face;

struct PathPrinter;


#[test]
fn test_glyphs() {
    


    //let fontName = "Roboto-Bold.ttf";
    let fontName = "laser.regular.ttf";
    let ttf_bytes = std::fs::read(format!("assets/fonts/{}", fontName)).unwrap();
    let face = Face::from_slice(&ttf_bytes, 0).unwrap();


    let text_data = DrawUtils::get_text_lines(&face, "DARKELF", None, None);

    let simplified_shapes = DrawUtils::layout_and_simplify_shapes(&text_data, false, true, true);


    // Serialize text_data to JSON and write to file
    let json = serde_json::to_string_pretty(&simplified_shapes).unwrap();
    std::fs::write("darkelf_coordinates.json", json).unwrap();
    println!("Wrote text_data to darkelf_coordinates.json");


    let cmd_text = CommandGenerator::get_xys_cmd(&simplified_shapes);
    println!("{}", cmd_text);

    let verify_text = "A0A1A2A300591083FF804F0183B0804F1183FF004F1183FF804F1183B080380183E880381183E800381183B000381183B08038118342004F018358004F21839C804F218383804F21837180242183298024218317804F2182FE804F218342004F218333800D018367800D21834D0030218333800D2182D300000182AE000031826A804F31824C804F318290000031827400003182EA004F3182EA804F3182D3804F3182D3000031827400170182D300173182D300383182730038318274001731819A004F0181B8004F418221802C418221004F418238004F418238804F418221804F4181EC80114181B8804F41819A804F4181DE000041819A004F418186804F0180E9804F5180E9803851816F803851816F00005180FF00005180FF001751816F001751816F00385180E900385180E9004F518186004F518186804F51803780380180BE80386180BE004F6180D5004F6180D5804F618037804F618037803861007B003801007B004F718023004F718023804F71800C804F71800C00007100640000710064001771800C001771800C003871007B00387100B7000000011B000000017F00000001E3000000024700000002AB000000030F000000037300000003D7000000011063B2B2B2B2B2B2646464646464646464090D0F0C0D070B01010101010101010100000000000001020303040405050607010203040506060606070708080909090005A4A5A6A7";
    assert_eq!(cmd_text, verify_text, "cmd_text does not match verify_text");
    println!("Wrote text_data to darkelf_coordinates.json");
}